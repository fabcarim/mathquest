<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <title>MathQuest ¬∑ 1¬™‚Äì2¬™ media (v18.2)</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=1, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="MathQuest">
  <meta name="format-detection" content="telephone=no">

  <link rel="manifest" href="manifest.webmanifest?v=181">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <link rel="stylesheet" href="styles.css?v=181">
</head>
<body>
  <div class="wrap">
    <header class="row space-between align-center">
      <h1 class="app-title">MathQuest <span class="kicker">1¬™‚Äì2¬™ media</span></h1>
      <div class="version-badge">v18.2</div>
    </header>

    <nav class="row gap nav-grid">
      <button class="btn" id="btnPlay">Gioca ora</button>
      <button class="btn" id="btnTrain">Allenamento mirato</button>
      <button class="btn" id="btnProg">Progressi</button>
      <button class="btn ghost" id="btnSettings">Impostazioni</button>
      <button class="btn ghost" id="btnHome">Home</button>
    </nav>

    <!-- HOME -->
    <section id="home" class="screen">
      <div class="row wrap gap">
        <div class="card flex1">
          <h2>Benvenuta!</h2>
          <p class="muted">
            Obiettivo di oggi: <b id="goalVal">20</b> risposte corrette.<br>
            Se ieri non lo raggiungi, oggi sale del <b>+10%</b>; se lo raggiungi, domani riparte da 20.
          </p>
          <div class="row gap stack">
            <button class="btn" id="startQuick">Inizia subito</button>
            <button class="btn ghost" id="startTrain">Scegli argomento</button>
          </div>
        </div>

        <div class="card flex1">
          <h2>Stato di oggi</h2>
          <div class="kicker">Conta solo il giorno corrente</div>
          <p>Corrette oggi: <b id="correctToday">0</b> / <b id="goalVal2">20</b></p>
          <div class="progress"><div class="bar" id="goalBar"></div></div>
          <p class="kicker" id="goalNote">‚Äî</p>
        </div>
      </div>

      <div class="card">
        <div class="row space-between align-center">
          <div>
            <div class="kicker">Cambia argomento rapido</div>
            <div id="quickTopics" class="row gap mt6 wrap"></div>
          </div>
          <div><button class="btn ghost" id="clearTopic">Nessun filtro</button></div>
        </div>
      </div>

      <div class="card">
        <h2>üèÖ Badge</h2>
        <div class="kicker">Guadagnati</div>
        <div id="homeBadgesEarned" class="badges-grid mt6"></div>
        <div class="kicker mt12">Da conquistare</div>
        <div id="homeBadgesLocked" class="badges-grid mt6"></div>
      </div>
    </section>

    <!-- ALLENAMENTO MIRATO -->
    <section id="train" class="screen hidden">
      <div class="card">
        <div class="row space-between align-center">
          <h2>Seleziona argomento</h2>
          <div class="row align-center gap">
            <span class="kicker">Difficolt√†</span>
            <div id="levels" class="row gap"></div>
          </div>
        </div>
        <div id="topics" class="row gap mt8 wrap"></div>
        <div class="row gap mt8 stack">
          <button class="btn" id="trainGo">Inizia allenamento</button>
          <button class="btn ghost" id="resetTopic">Reset argomento</button>
        </div>
      </div>
    </section>

    <!-- PLAY -->
    <section id="play" class="screen hidden">
      <div class="card">
        <div class="row space-between align-center">
          <div>
            <div id="topicLabel" class="kicker">Allenamento: Tutti gli argomenti</div>
            <div class="muted">Difficolt√† <span id="diffLabel">2</span> <span class="kicker" id="autoDiffTag"></span></div>
          </div>
          <div class="muted">Serie corretta: <b id="streak">0</b></div>
        </div>

        <div id="stem" class="stem">‚Äî</div>
        <div id="stemMeta" class="kicker"></div>

        <div id="answerUI" class="mt10"></div>

        <div class="row gap mt10 align-center stack">
          <button class="btn" id="btnConfirm">Conferma</button>
          <button class="btn ghost" id="btnNext" disabled>Prossima</button>
          <button class="btn ghost" id="btnHint">Mostra hint</button>
          <button class="btn ghost" id="btnSimilar">Esempio simile</button>
        </div>

        <div id="feedback" class="mt10"></div>
        <div id="hints" class="hint mt10 hidden"></div>
      </div>

      <div class="row wrap gap mt12">
        <div class="card flex1">
          <div>Oggi corrette: <b id="corToday2">0</b> / <b id="goalSmall">20</b></div>
          <div class="progress mt6"><div class="bar" id="goalBar2"></div></div>
          <div class="kicker" id="goalHint"></div>
        </div>
        <div class="card flex1">
          <div>Badge</div>
          <div id="badges" class="row gap mt6 wrap"></div>
        </div>
      </div>
    </section>

    <footer class="footer">
      <div>Consigli: 10‚Äì15 min al giorno. Privacy: dati solo in locale.</div>
      <div class="muted">Build: <b>v18.2</b></div>
    </footer>
  </div>

  <!-- Overlay: nascosto via style inline -->
  <div class="overlay" id="overlay" aria-hidden="true" style="display:none">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="goalTitle">
      <h2 id="goalTitle">üéâ Obiettivo raggiunto!</h2>
      <div class="kicker">Hai raggiunto <b id="goalCount"></b>/<b id="goalCountTot"></b> risposte corrette oggi</div>
      <div class="kicker">Accuracy: <b id="goalAcc"></b>%</div>
      <button class="btn" id="btnHomeNow">Torna alla Home</button>
      <div class="kicker mt8">Torno automaticamente alla Home tra <span id="countdown">5</span>s‚Ä¶</div>
    </div>
  </div>

  <!-- Registra il Service Worker (v18.2) -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function(){
        navigator.serviceWorker.register('sw.js?v=182').catch(function(e){ console.log('SW reg error', e); });
      });
    }
  </script>

  <!-- App -->
  <script src="app.js?v=181" defer></script>
</body>
</html>
